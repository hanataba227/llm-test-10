<!-- main.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>CTF05 XSS ì‹œë®¬ë ˆì´ì…˜</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }
        #output {
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 10px;
            min-height: 50px;
        }
        #flag_area {
            margin-top: 20px;
            color: green;
        }
    </style>
</head>
<body>
    <h2>ğŸ”’ CTF05: Improper Output Handling ì‹œë®¬ë ˆì´ì…˜</h2>
    <p>ğŸ“¢ ì™¸ë¶€ ìŠ¤í¬ë¦½íŠ¸(fetch) â†’ ì„¸ì…˜ íƒˆì·¨ â†’ LLM ê²°ê³¼ ì‚½ì… â†’ ë¦¬ë‹¤ì´ë ‰ì…˜</p>

    <!-- 1) LLM ê²°ê³¼ê°€ ë“¤ì–´ê°ˆ ì˜ì—­ -->
<h3>ğŸ“ LLM ì‘ë‹µ ê²°ê³¼:</h3>
<div id="output">{{LLM_RESPONSE}}</div>
<div id="flag_area" style="margin-top:20px; color:green;"></div>

<script>
(function(){
        const raw = document.getElementById("output").innerHTML;
        if (raw.includes("<script")) {
          // "alert()" ë“± ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ëœ ë’¤ì— ì´ ì¡°ê±´ì´ trueë¡œ íŒë‹¨ë©ë‹ˆë‹¤.
          // ì—¬ê¸°ì„œ Flask ì„œë²„ì˜ /flag ì—”ë“œí¬ì¸íŠ¸ë¡œ í˜¸ì¶œì„ í•©ë‹ˆë‹¤.
          fetch("http://localhost:5001/flag")
            .then(res => {
              if (!res.ok) throw new Error("í”Œë˜ê·¸ ìš”ì²­ ì‹¤íŒ¨: " + res.status);
              return res.text();
            })
            .then(flagText => {
              document.getElementById("flag_area").innerText = "ğŸ‰ FLAG: " + flagText;
            })
            .catch(err => {
              document.getElementById("flag_area").innerText = "âš ï¸ í”Œë˜ê·¸ ë¡œë”© ì‹¤íŒ¨: " + err;
            });

    }
})();
</script>
</body>
</html>
